# =============================================================================
# Default TLS Backend (Passthrough)
# =============================================================================
# This upstream handles TLS passthrough traffic on port 443 that doesn't
# match any specific domain with TLS termination configured.
#
# In passthrough mode, Envoy forwards the encrypted TLS traffic directly
# to this backend without decrypting it. The backend handles TLS termination.
#
# Common use cases:
#   - Route to Kubernetes ingress controller
#   - Forward to another reverse proxy
#   - Pass to services that must handle their own TLS (mTLS, client certs)
#
# Referenced by: common/defaults.yaml -> tls_passthrough_upstream

# Unique name for this upstream (must match defaults.yaml reference)
name: default_tls_backend

# Connection timeout to backend hosts
connect_timeout: 5s

# Service discovery type
type: STRICT_DNS

# Load balancing algorithm
lb_policy: ROUND_ROBIN

# Backend endpoints for TLS passthrough traffic
# The port should be the TLS port on your backend (usually 443 or a NodePort)
# Examples:
#   - Kubernetes NodePort: { address: "k8s-node-1", port: 32443 }
#   - Another proxy: { address: "nginx-ingress", port: 443 }
#   - Direct service: { address: "10.0.0.20", port: 443 }
endpoints:
  - { address: "localhost", port: 8443 }
  # Add more endpoints for load balancing:
  # - { address: "backend-2", port: 8443 }
  # - { address: "backend-3", port: 8443 }
